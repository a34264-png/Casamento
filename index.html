<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leonor & Manuel — Casamento</title>
  <style>
    /* ======== Reset & fontes ======== */
    * { margin:0; padding:0; box-sizing:border-box; font-family: 'Georgia', serif; }
    body { 
      background: linear-gradient(to bottom, #f5f0e6 0%, #e0eaf6 100%);
      color: #0d1b3d; line-height:1.6; 
    }

    /* ======== Navegação fixa ======== */
    nav { 
      position:fixed; top:0; left:0; right:0; 
      background: rgba(255,255,255,0.9); 
      box-shadow:0 2px 4px rgba(0,0,0,0.1); 
      z-index:1000; padding:10px 20px; display:flex; justify-content:flex-end; 
    }
    nav a { margin-left:20px; font-weight:bold; color:#0d1b3d; }
    nav a:hover { color:#142b57; }
    .menu-icon { display:none; cursor:pointer; }
    @media(max-width:768px) {
      nav { flex-direction:column; align-items:flex-start; }
      .menu-icon { display:block; margin-bottom:5px; }
      nav a { display:none; margin:8px 0; }
      nav.show a { display:block; }
    }

    /* ======== Secções ======== */
    section { 
      padding:100px 20px 60px 20px; 
      min-height:100vh; 
      background: rgba(255,255,255,0.7); 
      border-radius:15px; 
      margin:20px auto;
      max-width:1200px;
      box-shadow:0 4px 15px rgba(0,0,0,0.1);
    }

    /* ======== Hero ======== */
    .hero { text-align:center; padding:120px 20px; }
    .hero h1 { font-size:3em; margin-bottom:10px; color:#0d1b3d; }
    .hero p { font-size:1.3em; margin-bottom:6px; }

    /* ======== Formulários ======== */
    form { background:#ffffffcc; padding:20px; border-radius:10px; max-width:500px; margin:auto; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    label { display:block; margin-top:10px; font-weight:bold; }
    input, select, textarea { width:100%; padding:8px; margin-top:5px; border:1px solid #ccc; border-radius:5px; }
    button { margin-top:15px; background:#0d1b3d; color:#fff; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; font-weight:bold; }
    button:hover { background:#142b57; }
    .small { font-size:0.9em; color:#6d6d6d; margin-top:8px; }

    /* ======== Presentes ======== */
    .gift-list { display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:20px; margin-top:20px; }
    .gift { background:#ffffffcc; padding:15px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); text-align:center; }
    .gift img { max-width:100%; border-radius:10px; }
    .progress-bar { height:15px; background:#ddd; border-radius:7px; margin-top:10px; }
    .progress-bar-inner { height:100%; background:#0d1b3d; border-radius:7px 0 0 7px; text-align:center; color:#fff; font-size:12px; line-height:15px; }

    /* ======== Alojamento ======== */
    .hotels ul { list-style:none; padding-left:0; }
    .hotels li { margin-bottom:10px; }

    /* ======== Mapa ======== */
    .map iframe { width:100%; height:400px; border:0; border-radius:10px; }

    footer { text-align:center; padding:20px 0; color:#6d6d6d; font-size:0.9em; }
  </style>
</head>
<body>

  <!-- Menu -->
  <nav id="nav">
    <span class="menu-icon" onclick="toggleNav()">☰ Menu</span>
    <a href="#cerimonia">Cerimónia</a>
    <a href="#rsvp">RSVP</a>
    <a href="#presentes">Presentes</a>
    <a href="#alojamento">Alojamento</a>
    <a href="#local">Localização</a>
  </nav>

  <!-- Hero -->
  <section id="cerimonia" class="hero">
    <h1>Leonor & Manuel</h1>
    <p>19 de Setembro de 2026 – 15h30</p>
    <p>Basílica do Bom Jesus de Braga</p>
    <p>Copo-de-água: Colónata Eventos</p>
  </section>

  <!-- RSVP -->
  <section id="rsvp">
    <h2>Confirmação de Presença (RSVP)</h2>
    <form id="rsvpForm">
      <label>Nome completo</label>
      <input type="text" name="name" required>
      <label>Vai comparecer?</label>
      <select name="attend" required>
        <option value="">-- Selecionar --</option>
        <option value="Sim">Sim</option>
        <option value="Não">Não</option>
      </select>
      <label>Acompanhante (opcional)</label>
      <input type="text" name="plus">
      <label>Alergias ou restrições alimentares</label>
      <textarea name="diet" rows="2"></textarea>
      <button type="submit">Enviar RSVP</button>
      <p id="rsvpMsg" class="small"></p>
    </form>
  </section>

  <!-- Presentes -->
  <section id="presentes">
    <h2>Lista de Presentes</h2>
    <p class="small">IBAN: PT5 1111 1111 1111 111 2 | MBWay: 924466710 ou 914260712</p>
    <div class="gift-list" id="giftList"></div>
  </section>

  <!-- Alojamento -->
  <section id="alojamento">
    <h2>Sugestões de Alojamento em Braga</h2>
    <div class="hotels">
      <ul>
        <li>Hotel Templo & Spa</li>
        <li>Hotel do Lago</li>
        <li>Hotel do Elevador</li>
        <li>Hotel do Parque</li>
        <li>Melia Braga</li>
      </ul>
    </div>
  </section>

  <!-- Localização -->
  <section id="local">
    <h2>Localização</h2>
    <div class="map">
      <iframe src="https://www.google.com/maps?q=Bas%C3%ADlica%20do%20Bom%20Jesus%20de%20Braga&output=embed" loading="lazy"></iframe>
    </div>
  </section>

  <footer>
    <p>Leonor & Manuel • 19 Setembro 2026</p>
  </footer>

  <script>
    const RSVP_ENDPOINT = "https://script.google.com/macros/s/AKfycbwy8ZSn5kLrw9prKJdngsFMZGBWiKS5QyFQFQNTHqjicp99vOCs3g6CkVw1NbkV-Agq/exec";
    const GIFTS_ENDPOINT = "https://script.google.com/macros/s/AKfycbwy8ZSn5kLrw9prKJdngsFMZGBWiKS5QyFQFQNTHqjicp99vOCs3g6CkVw1NbkV-Agq/exec";

    // Menu responsivo
    function toggleNav() { document.getElementById("nav").classList.toggle("show"); }

    // RSVP
    document.getElementById("rsvpForm").addEventListener("submit", async function(e){
      e.preventDefault();
      const data = {
        action:"rsvp",
        name:this.name.value.trim(),
        attend:this.attend.value,
        plus:this.plus.value.trim(),
        diet:this.diet.value.trim()
      };
      const msgEl = document.getElementById("rsvpMsg");
      msgEl.textContent = "A enviar...";
      try {
        const resp = await fetch(RSVP_ENDPOINT,{
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body:JSON.stringify(data)
        });
        const j = await resp.json();
        if(j.success){ msgEl.textContent="RSVP enviado com sucesso!"; this.reset(); }
        else{ msgEl.textContent="Erro ao enviar RSVP."; }
      } catch(err){ msgEl.textContent="Erro de rede ao enviar RSVP."; }
    });

    // Presentes
    async function loadGifts(){
      try{
        const resp = await fetch(GIFTS_ENDPOINT + "?action=list");
        const j = await resp.json();
        const giftList = document.getElementById("giftList");
        giftList.innerHTML = "";
        if(j.success && Array.isArray(j.items)){
          j.items.forEach(g=>{
            const perc = g.price>0?Math.min(100,(g.contributed/g.price)*100):0;
            const div=document.createElement("div");
            div.className="gift";
            div.innerHTML=`
              <img src="${g.img||''}" alt="${g.title}">
              <h3>${g.title}</h3>
              <p>Preço: €${g.price.toFixed(2)}</p>
              <div class="progress-bar"><div class="progress-bar-inner" style="width:${perc}%;">${g.contributed>0?'€'+g.contributed.toFixed(2):''}</div></div>
              ${perc<100?`<form data-id="${g.id}"><input type="number" name="amount" placeholder="€" min="1" required><button type="submit">Contribuir</button></form>`:`<p class="small">Presente já concluído!</p>`}
            `;
            giftList.appendChild(div);
            const form = div.querySelector("form");
            if(form){
              form.addEventListener("submit", async function(e){
                e.preventDefault();
                const amount=parseFloat(this.amount.value);
                if(isNaN(amount)||amount<=0)return;
                const payload={action:"contribute", itemId:this.dataset.id, name:"", amount:amount};
                try{
                  const resp2 = await fetch(GIFTS_ENDPOINT,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(payload)});
                  const j2=await resp2.json();
                  if(j2.success) loadGifts(); else alert("Erro ao submeter contribuição.");
                }catch(err){ console.error(err); alert("Erro de rede ao submeter contribuição.");}
              });
            }
          });
        }else giftList.innerHTML="<p class='small'>Nenhum presente disponível.</p>";
      }catch(err){ console.error(err); giftList.innerHTML="<p class='small'>Erro ao carregar presentes.</p>";}
    }
    loadGifts();
  </script>
</body>
</html>

